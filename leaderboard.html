<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
        <link rel="manifest" href="assets/favicon/site.webmanifest">
		<meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1.0"/>
		<title>LiClick</title>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
		<link rel="stylesheet" href="assets/css/style.css">
	</head>
	<body class="bg-secondary">
        <div class="headers">
            <span>Рейтинг учеников</span>
        </div>
        <div class="leaderboard"></div>
        <div class="loader">
            <img src="assets/img/loader.gif" alt="load"/>
        </div>
        <script>
            const app = Telegram.WebApp;
            app.ready();
            app.expand();
            app.enableClosingConfirmation()
            app.BackButton.show();
            app.BackButton.onClick(function() {
                history.back();
                app.BackButton.hide();
            });
            app.enableClosingConfirmation();
            const loader = document.querySelector(".loader");
            const leaderboard = document.querySelector(".leaderboard");
            const body = { "count": 1 };
            fetch('https://api.lyclick.lc12.ru/leader', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(body)
            })
            .then(response => response.json())
            .then(response => {
                count=1
                for (user of response){
                    let tableRow = document.createElement("div");
                    tableRow.classList.add("table-row");

                    let lr = document.createElement("div");
                    lr.classList.add("l-r");

                    let num_div = document.createElement("div");
                    num_div.classList.add('l-num');               
                    num_div.innerText = '#'+count;

                    let cont = document.createElement("div");
                    cont.classList.add('l-container');

                    let l_username = document.createElement("span");
                    l_username.classList.add("l-username");

                    let rank_div = document.createElement("span");
                    rank_div.classList.add('l-rank');
                    rank_div.innerText = user.rank

                    let l_score = document.createElement("div");
                    l_score.classList.add("l-score");

                    lr.appendChild(num_div);
                    lr.appendChild(cont);
                    cont.appendChild(l_username);
                    cont.appendChild(rank_div);                 
                    
                    
                    l_username.innerText = user.username;
                    l_score.innerText = user.score;
                    tableRow.appendChild(lr);
                    tableRow.appendChild(l_score);
                    leaderboard.appendChild(tableRow);
                    count+=1;
                }
                
                loader.className += " hidden";
            })
        </script>
	</body>
</html>